"use strict";(self.webpackChunkdocusaurus_docs=self.webpackChunkdocusaurus_docs||[]).push([[1823],{3905:(t,e,a)=>{a.d(e,{Zo:()=>m,kt:()=>g});var n=a(67294);function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function i(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function o(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},i=Object.keys(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var d=n.createContext({}),p=function(t){var e=n.useContext(d),a=e;return t&&(a="function"==typeof t?t(e):l(l({},e),t)),a},m=function(t){var e=p(t.components);return n.createElement(d.Provider,{value:e},t.children)},s={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},k=n.forwardRef((function(t,e){var a=t.components,r=t.mdxType,i=t.originalType,d=t.parentName,m=o(t,["components","mdxType","originalType","parentName"]),k=p(a),g=r,c=k["".concat(d,".").concat(g)]||k[g]||s[g]||i;return a?n.createElement(c,l(l({ref:e},m),{},{components:a})):n.createElement(c,l({ref:e},m))}));function g(t,e){var a=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var i=a.length,l=new Array(i);l[0]=k;var o={};for(var d in e)hasOwnProperty.call(e,d)&&(o[d]=e[d]);o.originalType=t,o.mdxType="string"==typeof t?t:r,l[1]=o;for(var p=2;p<i;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}k.displayName="MDXCreateElement"},28019:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>d,contentTitle:()=>l,default:()=>s,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var n=a(87462),r=(a(67294),a(3905));const i={title:"Agreement Deduction API",sidebar_label:"Deduction",sidebar_position:5},l=void 0,o={unversionedId:"recurring-payments/deduction",id:"recurring-payments/deduction",title:"Agreement Deduction API",description:"HTTP Request",source:"@site/docs/recurring-payments/deduction.mdx",sourceDirName:"recurring-payments",slug:"/recurring-payments/deduction",permalink:"/pay-docs/zh-TW/recurring-payments/deduction",draft:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"Agreement Deduction API",sidebar_label:"Deduction",sidebar_position:5},sidebar:"bbyPaySideBar",previous:{title:"List Agreements",permalink:"/pay-docs/zh-TW/recurring-payments/list-agreements"},next:{title:"Pay with Sign",permalink:"/pay-docs/zh-TW/recurring-payments/pay-with-sign"}},d={},p=[{value:"HTTP Request",id:"http-request",level:2},{value:"Request Parameters",id:"request-parameters",level:2},{value:"Response Parameters",id:"response-parameters",level:2},{value:"Request Examples",id:"request-examples",level:2},{value:"Cryptocurrency Order",id:"cryptocurrency-order",level:3},{value:"Fiat Currency Order",id:"fiat-currency-order",level:3},{value:"Response Examples",id:"response-examples",level:2},{value:"Crypto Order Success",id:"crypto-order-success",level:3},{value:"Fiat Order Success (with Crypto Payment)",id:"fiat-order-success-with-crypto-payment",level:3},{value:"Processing Status",id:"processing-status",level:3},{value:"Deduction Failed",id:"deduction-failed",level:3},{value:"Verification Steps",id:"verification-steps",level:2},{value:"Notes",id:"notes",level:2}],m={toc:p};function s(t){let{components:e,...a}=t;return(0,r.kt)("wrapper",(0,n.Z)({},m,a,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"http-request"},"HTTP Request"),(0,r.kt)("p",null,"POST ",(0,r.kt)("inlineCode",{parentName:"p"},"/v5/bybitpay/agreement/pay")),(0,r.kt)("p",null,"Execute automatic deduction from user's account using a signed agreement. This is the core API for agreement payment."),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"request-parameters"},"Request Parameters"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Required"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"merchant_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Merchant ID")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"user_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Platform user ID")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"agreement_type"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Sign type: ",(0,r.kt)("inlineCode",{parentName:"td"},"CYCLE")," / ",(0,r.kt)("inlineCode",{parentName:"td"},"NON_CYCLE")," / ",(0,r.kt)("inlineCode",{parentName:"td"},"SINGLE"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"agreement_no"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Platform agreement number")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"out_trade_no"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Merchant order number (unique)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"scene_code"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("a",{parentName:"td",href:"appendix#scene-codes"},"Scene code"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"amount"),(0,r.kt)("td",{parentName:"tr",align:"left"},"object"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Deduction amount")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"amount.total"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Amount (minimum unit)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"amount.currency"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Currency code")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"amount.currency_type"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"FIAT")," or ",(0,r.kt)("inlineCode",{parentName:"td"},"CRYPTO"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"amount.chain"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Chain network (required for crypto)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"order_info"),(0,r.kt)("td",{parentName:"tr",align:"left"},"object"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Order information")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"order_info.order_title"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Order title (displayed to user)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"order_info.order_desc"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Order description")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"order_info.goods_name"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Goods name")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"order_info.goods_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Goods ID")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"order_info.goods_category"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Goods category")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"scene_info"),(0,r.kt)("td",{parentName:"tr",align:"left"},"object"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Scene information")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"scene_info.device_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Device ID")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"scene_info.device_ip"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Device IP")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"scene_info.location"),(0,r.kt)("td",{parentName:"tr",align:"left"},"object"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Location information")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"scene_info.location.latitude"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Latitude")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"scene_info.location.longitude"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Longitude")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"scene_info.location.address"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Detailed address")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"notify_url"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Deduction result webhook URL")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"risk_info"),(0,r.kt)("td",{parentName:"tr",align:"left"},"object"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Risk control information")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"risk_info.user_ip"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"User IP address")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"risk_info.device_fingerprint"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Device fingerprint")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"risk_info.user_agent"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"No"),(0,r.kt)("td",{parentName:"tr",align:"left"},"User agent string")))),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"response-parameters"},"Response Parameters"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"code"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Response code")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"message"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Response message")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data"),(0,r.kt)("td",{parentName:"tr",align:"left"},"object"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Response data")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data.order_no"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Platform order number")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data.trade_no"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Platform trade number")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data.out_trade_no"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Merchant order number")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data.status"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Transaction status: ",(0,r.kt)("inlineCode",{parentName:"td"},"PROCESSING")," / ",(0,r.kt)("inlineCode",{parentName:"td"},"SUCCESS")," / ",(0,r.kt)("inlineCode",{parentName:"td"},"FAILED")," / ",(0,r.kt)("inlineCode",{parentName:"td"},"TIMEOUT"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data.amount"),(0,r.kt)("td",{parentName:"tr",align:"left"},"object"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Requested amount")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data.crypto_payment"),(0,r.kt)("td",{parentName:"tr",align:"left"},"object"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Actual crypto payment info (for fiat orders)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data.crypto_payment.currency"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Cryptocurrency (e.g., USDT)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data.crypto_payment.amount"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Cryptocurrency amount")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data.crypto_payment.chain"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Chain network")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data.crypto_payment.exchange_rate"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Exchange rate")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data.crypto_payment.rate_time"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Rate lock time")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data.pay_time"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Payment time (on success)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"data.failure_reason"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Failure reason (on failure)")))),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"request-examples"},"Request Examples"),(0,r.kt)("h3",{id:"cryptocurrency-order"},"Cryptocurrency Order"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-http"},'POST /v5/bybitpay/agreement/pay HTTP/1.1\nHost: api.bybit.com\nContent-Type: application/json\nX-Request-Id: 550e8400-e29b-41d4-a716-446655440005\nX-Timestamp: 1736233200000\nX-Signature: {signature}\nAuthorization: Bearer {access_token}\n\n{\n  "merchant_id": "M123456789",\n  "user_id": "U_123456789",\n  "agreement_type": "CYCLE",\n  "agreement_no": "AGR202601070001",\n  "out_trade_no": "ORDER20260107001",\n  "scene_code": "SUBSCRIPTION",\n  "amount": {\n    "total": "2350",\n    "currency": "USDT",\n    "currency_type": "CRYPTO",\n    "chain": "TRC20"\n  },\n  "order_info": {\n    "order_title": "Monthly subscription - January 2026",\n    "order_desc": "Premium membership",\n    "goods_name": "Premium Plan",\n    "goods_id": "PREMIUM_001"\n  },\n  "notify_url": "https://merchant.com/notify/pay"\n}\n')),(0,r.kt)("h3",{id:"fiat-currency-order"},"Fiat Currency Order"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-http"},'POST /v5/bybitpay/agreement/pay HTTP/1.1\nHost: api.bybit.com\nContent-Type: application/json\nX-Request-Id: 550e8400-e29b-41d4-a716-446655440006\nX-Timestamp: 1736233200000\nX-Signature: {signature}\nAuthorization: Bearer {access_token}\n\n{\n  "merchant_id": "M123456789",\n  "user_id": "U_123456789",\n  "agreement_type": "CYCLE",\n  "agreement_no": "AGR202601070001",\n  "out_trade_no": "ORDER20260107002",\n  "scene_code": "TAXI",\n  "amount": {\n    "total": "10000",\n    "currency": "USD",\n    "currency_type": "FIAT"\n  },\n  "order_info": {\n    "order_title": "Ride fare",\n    "order_desc": "Trip from A to B"\n  },\n  "scene_info": {\n    "device_id": "DEVICE_001",\n    "device_ip": "192.168.1.1",\n    "location": {\n      "latitude": "39.9042",\n      "longitude": "116.4074",\n      "address": "Beijing, China"\n    }\n  },\n  "risk_info": {\n    "user_ip": "203.0.113.45",\n    "device_fingerprint": "fp_abc123xyz"\n  },\n  "notify_url": "https://merchant.com/notify/pay"\n}\n')),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"response-examples"},"Response Examples"),(0,r.kt)("h3",{id:"crypto-order-success"},"Crypto Order Success"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "code": "SUCCESS",\n  "message": "ok",\n  "data": {\n    "order_no": "ORD202601070001",\n    "trade_no": "PAY202601070001",\n    "out_trade_no": "ORDER20260107001",\n    "status": "SUCCESS",\n    "amount": {\n      "total": "2350",\n      "currency": "USDT",\n      "currency_type": "CRYPTO",\n      "chain": "TRC20"\n    },\n    "pay_time": "2026-01-07T10:30:00Z"\n  }\n}\n')),(0,r.kt)("h3",{id:"fiat-order-success-with-crypto-payment"},"Fiat Order Success (with Crypto Payment)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "code": "SUCCESS",\n  "message": "ok",\n  "data": {\n    "order_no": "ORD202601070002",\n    "trade_no": "PAY202601070002",\n    "out_trade_no": "ORDER20260107002",\n    "status": "SUCCESS",\n    "amount": {\n      "total": "10000",\n      "currency": "USD",\n      "currency_type": "FIAT"\n    },\n    "crypto_payment": {\n      "currency": "USDT",\n      "amount": "10005.50",\n      "chain": "TRC20",\n      "exchange_rate": "1.00055",\n      "rate_time": "2026-01-07T10:29:55Z"\n    },\n    "pay_time": "2026-01-07T10:30:00Z"\n  }\n}\n')),(0,r.kt)("h3",{id:"processing-status"},"Processing Status"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "code": "SUCCESS",\n  "message": "ok",\n  "data": {\n    "order_no": "ORD202601070003",\n    "trade_no": "PAY202601070003",\n    "out_trade_no": "ORDER20260107003",\n    "status": "PROCESSING",\n    "amount": {\n      "total": "5000",\n      "currency": "USDT",\n      "currency_type": "CRYPTO",\n      "chain": "TRC20"\n    }\n  }\n}\n')),(0,r.kt)("h3",{id:"deduction-failed"},"Deduction Failed"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "code": "SUCCESS",\n  "message": "ok",\n  "data": {\n    "order_no": "ORD202601070004",\n    "trade_no": "PAY202601070004",\n    "out_trade_no": "ORDER20260107004",\n    "status": "FAILED",\n    "amount": {\n      "total": "5000",\n      "currency": "USDT",\n      "currency_type": "CRYPTO",\n      "chain": "TRC20"\n    },\n    "failure_reason": "BALANCE_NOT_ENOUGH"\n  }\n}\n')),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"verification-steps"},"Verification Steps"),(0,r.kt)("p",null,"Platform performs the following checks before executing deduction:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Agreement Validity"),": Agreement must be in ",(0,r.kt)("inlineCode",{parentName:"li"},"SIGNED")," status"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Single Limit Check"),": Amount does not exceed single transaction limit"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Period Limit Check"),": Cumulative amount does not exceed period limit"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Balance Check"),": User account has sufficient balance"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Risk Check"),": Transaction passes risk control rules")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"notes"},"Notes"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Idempotency"),": Same ",(0,r.kt)("inlineCode",{parentName:"li"},"out_trade_no")," returns result of first request"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Async Processing"),": ",(0,r.kt)("inlineCode",{parentName:"li"},"PROCESSING")," status requires waiting for webhook or query"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Timeout Handling"),": Set 30-second timeout, query if timeout occurs"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Fiat Orders"),": User pays with cryptocurrency; ",(0,r.kt)("inlineCode",{parentName:"li"},"crypto_payment")," shows actual payment details")))}s.isMDXComponent=!0}}]);